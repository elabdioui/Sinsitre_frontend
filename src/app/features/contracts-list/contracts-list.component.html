<!-- src/app/features/contracts-list/contracts-list.component.html -->

<section class="contracts-page">
    <div class="contracts-shell">
      <!-- Header -->
      <header class="contracts-header">
        <div>
          <h1>Contrats d'assurance</h1>
          <p>Vue centralis√©e de tous les contrats cr√©√©s dans le syst√®me.</p>
        </div>
  
        <div class="header-actions">
          <span class="badge-count">
            <span class="dot"></span>
            {{ contracts.length }} contrat(s)
          </span>
  
          <button type="button" class="btn-ghost" (click)="loadContracts()">
            ‚ü≥ Actualiser
          </button>
        </div>
      </header>
  
      <!-- Carte principale -->
      <div class="card contracts-card">
        <div class="card-header">
          <div>
            <h2>Liste des contrats</h2>
            <p>Surveillez les statuts et g√©rez les contrats en temps r√©el.</p>
          </div>
        </div>
  
        <div class="card-body">
          <!-- √âtats -->
          <div *ngIf="loading" class="state state--info">
            Chargement des contrats...
          </div>
  
          <div *ngIf="error && !loading" class="state state--error">
            {{ error }}
          </div>
  
          <div
            *ngIf="!loading && !error && (!contracts || contracts.length === 0)"
            class="state-empty"
          >
            <div class="empty-icon">üìÑ</div>
            <h3>Aucun contrat enregistr√©</h3>
            <p>
              Commencez par cr√©er un contrat depuis le back-office ou via les
              microservices.
            </p>
          </div>
  
          <div
            *ngIf="!loading && !error && contracts && contracts.length > 0"
            class="table-wrapper"
          >
            <table class="contracts-table">
              <thead>
                <tr>
                  <th>ID</th>
                  <th>Client</th>
                  <th>Type</th>
                  <th>Prime annuelle</th>
                  <th>D√©but</th>
                  <th>Fin</th>
                  <th>Statut</th>
                  <th class="col-actions">Actions</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let c of contracts">
                  <td>#{{ c.id }}</td>
                  <td>
                    <div class="cell-main">
                      <span class="cell-title">Client {{ c.clientId }}</span>
                      <span class="cell-sub">
                        {{ c.clientNom || 'Nom non disponible' }}
                      </span>
                    </div>
                  </td>
                  <td>{{ c.type }}</td>
                  <td>{{ c.primeAnnuelle | number: '1.0-0' }} DH</td>
                  <td>{{ c.startDate | date: 'dd/MM/yyyy' }}</td>
                  <td>{{ c.endDate | date: 'dd/MM/yyyy' }}</td>
                  <td>
                    <span
                      class="status-pill"
                      [ngClass]="{
                        'status-pill--active': c.status === contractStatusEnum.ACTIVE,
                        'status-pill--canceled': c.status === contractStatusEnum.CANCELED,
                        'status-pill--expired': c.status === contractStatusEnum.EXPIRED
                      }"
                    >
                      {{ c.status || 'N/A' }}
                    </span>
                  </td>
                  <td class="col-actions">
                    <button
                      type="button"
                      class="btn-outline"
                      (click)="cancelContract(c)"
                      [disabled]="c.status === contractStatusEnum.CANCELED"
                    >
                      Annuler
                    </button>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </section>
  